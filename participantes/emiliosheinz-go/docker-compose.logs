
 api02 Pulling 
 api01 Pulling 
 01d036902a3c Already exists 
 12574f077891 Pulling fs layer 
 e0e26ccfbead Pulling fs layer 
 01d036902a3c Already exists 
 12574f077891 Pulling fs layer 
 e0e26ccfbead Pulling fs layer 
 12574f077891 Downloading [>                                                  ]  26.03kB/2.554MB
 12574f077891 Downloading [>                                                  ]  26.03kB/2.554MB
 e0e26ccfbead Downloading [>                                                  ]   86.1kB/7.897MB
 e0e26ccfbead Downloading [>                                                  ]   86.1kB/7.897MB
 12574f077891 Downloading [=========>                                         ]  506.7kB/2.554MB
 12574f077891 Downloading [=========>                                         ]  506.7kB/2.554MB
 12574f077891 Verifying Checksum 
 12574f077891 Download complete 
 12574f077891 Download complete 
 12574f077891 Extracting [>                                                  ]  32.77kB/2.554MB
 12574f077891 Extracting [>                                                  ]  32.77kB/2.554MB
 e0e26ccfbead Downloading [=========================================>         ]  6.485MB/7.897MB
 e0e26ccfbead Downloading [=========================================>         ]  6.485MB/7.897MB
 e0e26ccfbead Verifying Checksum 
 e0e26ccfbead Download complete 
 e0e26ccfbead Verifying Checksum 
 e0e26ccfbead Download complete 
 12574f077891 Extracting [==================================================>]  2.554MB/2.554MB
 12574f077891 Extracting [==================================================>]  2.554MB/2.554MB
 12574f077891 Extracting [==================================================>]  2.554MB/2.554MB
 12574f077891 Extracting [==================================================>]  2.554MB/2.554MB
 12574f077891 Pull complete 
 12574f077891 Pull complete 
 e0e26ccfbead Extracting [>                                                  ]   98.3kB/7.897MB
 e0e26ccfbead Extracting [>                                                  ]   98.3kB/7.897MB
 e0e26ccfbead Extracting [==================================================>]  7.897MB/7.897MB
 e0e26ccfbead Extracting [==================================================>]  7.897MB/7.897MB
 e0e26ccfbead Pull complete 
 e0e26ccfbead Pull complete 
 api02 Pulled 
 api01 Pulled 
 Network rinha  Creating
 Network rinha  Created
 Container redis  Creating
 Container postgres  Creating
 Container postgres  Created
 Container redis  Created
 Container api02  Creating
 Container api01  Creating
 Container api02  Created
 Container api01  Created
 Container nginx  Creating
 Container nginx  Created
Attaching to api01, api02, nginx, postgres, redis
postgres  | The files belonging to this database system will be owned by user "postgres".
postgres  | This user must also own the server process.
postgres  | 
postgres  | The database cluster will be initialized with locale "en_US.utf8".
postgres  | The default database encoding has accordingly been set to "UTF8".
postgres  | The default text search configuration will be set to "english".
postgres  | 
postgres  | Data page checksums are disabled.
postgres  | 
postgres  | fixing permissions on existing directory /var/lib/postgresql/data ... ok
postgres  | creating subdirectories ... ok
postgres  | selecting dynamic shared memory implementation ... posix
postgres  | selecting default "max_connections" ... 100
redis     | Starting Redis Server
postgres  | selecting default "shared_buffers" ... 128MB
redis     | 1:C 03 Aug 2025 20:39:05.806 # WARNING Memory overcommit must be enabled! Without it, a background save or replication may fail under low memory condition. Being disabled, it can also cause failures without low memory condition, see https://github.com/jemalloc/jemalloc/issues/1328. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.
postgres  | selecting default time zone ... UTC
postgres  | creating configuration files ... ok
postgres  | running bootstrap script ... ok
postgres  | sh: locale: not found
postgres  | 2025-08-03 20:39:08.319 UTC [35] WARNING:  no usable system locales were found
postgres  | performing post-bootstrap initialization ... ok
postgres  | initdb: warning: enabling "trust" authentication for local connections
postgres  | initdb: hint: You can change this by editing pg_hba.conf or using the option -A, or --auth-local and --auth-host, the next time you run initdb.
postgres  | syncing data to disk ... ok
postgres  | 
postgres  | 
postgres  | Success. You can now start the database server using:
postgres  | 
postgres  |     pg_ctl -D /var/lib/postgresql/data -l logfile start
postgres  | 
postgres  | waiting for server to start....2025-08-03 20:39:11.716 UTC [53] LOG:  starting PostgreSQL 17.5 on x86_64-pc-linux-musl, compiled by gcc (Alpine 14.2.0) 14.2.0, 64-bit
postgres  | 2025-08-03 20:39:11.721 UTC [53] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
postgres  | 2025-08-03 20:39:11.803 UTC [56] LOG:  database system was shut down at 2025-08-03 20:39:11 UTC
postgres  | 2025-08-03 20:39:11.826 UTC [53] LOG:  database system is ready to accept connections
postgres  |  done
postgres  | server started
postgres  | CREATE DATABASE
postgres  | 
postgres  | 
postgres  | /usr/local/bin/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/script.sql
postgres  | psql:/docker-entrypoint-initdb.d/script.sql:1: NOTICE:  table "payments" does not exist, skipping
postgres  | DROP TABLE
postgres  | CREATE TYPE
postgres  | CREATE TABLE
postgres  | CREATE INDEX
postgres  | CREATE INDEX
postgres  | CREATE INDEX
postgres  | 
postgres  | 
postgres  | waiting for server to shut down....2025-08-03 20:39:12.624 UTC [53] LOG:  received fast shutdown request
postgres  | 2025-08-03 20:39:12.630 UTC [53] LOG:  aborting any active transactions
postgres  | 2025-08-03 20:39:12.633 UTC [53] LOG:  background worker "logical replication launcher" (PID 59) exited with exit code 1
postgres  | 2025-08-03 20:39:12.702 UTC [54] LOG:  shutting down
postgres  | 2025-08-03 20:39:12.708 UTC [54] LOG:  checkpoint starting: shutdown immediate
postgres  | 2025-08-03 20:39:12.937 UTC [54] LOG:  checkpoint complete: wrote 937 buffers (5.7%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.058 s, sync=0.122 s, total=0.236 s; sync files=309, longest=0.023 s, average=0.001 s; distance=4289 kB, estimate=4289 kB; lsn=0/191D740, redo lsn=0/191D740
postgres  | 2025-08-03 20:39:12.948 UTC [53] LOG:  database system is shut down
postgres  |  done
postgres  | server stopped
postgres  | 
postgres  | PostgreSQL init process complete; ready for start up.
postgres  | 
api02     | 2025/08/03 20:39:13 Configuration initialized successfully
api02     | 2025/08/03 20:39:13 Attempt 1/10: Failed to ping database: dial tcp 172.20.0.2:5432: connect: connection refused
api01     | 2025/08/03 20:39:13 Configuration initialized successfully
api01     | 2025/08/03 20:39:13 Attempt 1/10: Failed to ping database: dial tcp 172.20.0.2:5432: connect: connection refused
postgres  | 2025-08-03 20:39:13.110 UTC [1] LOG:  starting PostgreSQL 17.5 on x86_64-pc-linux-musl, compiled by gcc (Alpine 14.2.0) 14.2.0, 64-bit
postgres  | 2025-08-03 20:39:13.110 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
postgres  | 2025-08-03 20:39:13.110 UTC [1] LOG:  listening on IPv6 address "::", port 5432
postgres  | 2025-08-03 20:39:13.129 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
postgres  | 2025-08-03 20:39:13.145 UTC [78] LOG:  database system was shut down at 2025-08-03 20:39:12 UTC
postgres  | 2025-08-03 20:39:13.154 UTC [1] LOG:  database system is ready to accept connections
api02     | Database connection established successfully
api02     | 2025/08/03 20:39:15 Default health status initialized for default: &{Failing:false MinResponseTime:0}
api02     | 2025/08/03 20:39:15 Default health status initialized for fallback: &{Failing:false MinResponseTime:0}
api02     | asynq: pid=1 2025/08/03 20:39:15.062152 INFO: Starting processing
api02     | asynq: pid=1 2025/08/03 20:39:15.062168 INFO: Send signal TSTP to stop processing new tasks
api02     | asynq: pid=1 2025/08/03 20:39:15.062172 INFO: Send signal TERM or INT to terminate the process
api01     | Database connection established successfully
api01     | asynq: pid=1 2025/08/03 20:39:15.104224 INFO: Starting processing
api01     | asynq: pid=1 2025/08/03 20:39:15.104251 INFO: Send signal TSTP to stop processing new tasks
api01     | asynq: pid=1 2025/08/03 20:39:15.104269 INFO: Send signal TERM or INT to terminate the process
nginx     | /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
nginx     | /docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
nginx     | /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
nginx     | 10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf
nginx     | 10-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf
nginx     | /docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh
nginx     | /docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
nginx     | /docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
nginx     | /docker-entrypoint.sh: Configuration complete; ready for start up
api02     | asynq: pid=1 2025/08/03 20:40:19.142032 WARN: Could not remove task id=c3271b3c-2a66-41bc-b4c4-b3e81c890000 type="payment:process" from "asynq:{api02}:active" err: INTERNAL_ERROR: redis eval error: i/o timeout; Will retry syncing
api01     | 2025/08/03 20:40:19 Error retrieving health for fallback: i/o timeout
api02     | asynq: pid=1 2025/08/03 20:40:19.145975 WARN: Could not remove task id=79a8aa3d-ea6c-42c3-a661-d9e908a70f08 type="payment:process" from "asynq:{api02}:active" err: INTERNAL_ERROR: redis eval error: i/o timeout; Will retry syncing
api01     | asynq: pid=1 2025/08/03 20:40:19.149367 WARN: Could not remove task id=7e362429-b37b-46ff-b8c9-742cd1b97057 type="payment:process" from "asynq:{api01}:active" err: INTERNAL_ERROR: redis eval error: i/o timeout; Will retry syncing
api02     | asynq: pid=1 2025/08/03 20:40:19.155401 WARN: Could not remove task id=ef275f8e-134e-48fb-a30b-a3bcaf809007 type="payment:process" from "asynq:{api02}:active" err: INTERNAL_ERROR: redis eval error: i/o timeout; Will retry syncing
api02     | asynq: pid=1 2025/08/03 20:40:19.155457 WARN: Could not remove task id=6f187d47-4eb2-489a-bc3e-f3e34b8e7d16 type="payment:process" from "asynq:{api02}:active" err: INTERNAL_ERROR: redis eval error: i/o timeout; Will retry syncing
api01     | asynq: pid=1 2025/08/03 20:40:19.173077 ERROR: Failed to forward scheduled tasks: INTERNAL_ERROR: INTERNAL_ERROR: redis eval error: i/o timeout
api01     | asynq: pid=1 2025/08/03 20:40:19.210304 WARN: Could not remove task id=b23e8cef-87ab-46c8-b68e-68c759d5ac1d type="payment:process" from "asynq:{api01}:active" err: INTERNAL_ERROR: redis eval error: NOT FOUND; Will retry syncing
api02     | asynq: pid=1 2025/08/03 20:40:19.226510 ERROR: Failed to delete expired completed tasks from queue "api02": INTERNAL_ERROR: redis eval error: i/o timeout
[Knginx exited with code 0
api02     | asynq: pid=1 2025/08/03 20:40:29.146245 INFO: Stopping processor
api01     | asynq: pid=1 2025/08/03 20:40:29.152268 INFO: Stopping processor
api01     | asynq: pid=1 2025/08/03 20:40:29.202492 INFO: Processor stopped
api01     | asynq: pid=1 2025/08/03 20:40:29.202509 INFO: Starting graceful shutdown
api01     | asynq: pid=1 2025/08/03 20:40:29.202516 INFO: Waiting for all workers to finish...
api02     | asynq: pid=1 2025/08/03 20:40:29.202589 INFO: Processor stopped
api02     | asynq: pid=1 2025/08/03 20:40:29.202601 INFO: Starting graceful shutdown
api02     | asynq: pid=1 2025/08/03 20:40:29.202884 INFO: Waiting for all workers to finish...
api02     | asynq: pid=1 2025/08/03 20:40:29.212198 INFO: All workers have finished
api02     | asynq: pid=1 2025/08/03 20:40:29.212265 ERROR: Could not remove task id=c3271b3c-2a66-41bc-b4c4-b3e81c890000 type="payment:process" from "asynq:{api02}:active" err: INTERNAL_ERROR: redis eval error: i/o timeout
api01     | asynq: pid=1 2025/08/03 20:40:29.212196 INFO: All workers have finished
api02     | asynq: pid=1 2025/08/03 20:40:29.212279 ERROR: Could not remove task id=79a8aa3d-ea6c-42c3-a661-d9e908a70f08 type="payment:process" from "asynq:{api02}:active" err: INTERNAL_ERROR: redis eval error: i/o timeout
api01     | asynq: pid=1 2025/08/03 20:40:29.212239 ERROR: Could not remove task id=7e362429-b37b-46ff-b8c9-742cd1b97057 type="payment:process" from "asynq:{api01}:active" err: INTERNAL_ERROR: redis eval error: i/o timeout
api01     | asynq: pid=1 2025/08/03 20:40:29.212260 ERROR: Could not remove task id=b23e8cef-87ab-46c8-b68e-68c759d5ac1d type="payment:process" from "asynq:{api01}:active" err: INTERNAL_ERROR: redis eval error: NOT FOUND
api02     | asynq: pid=1 2025/08/03 20:40:29.212288 ERROR: Could not remove task id=ef275f8e-134e-48fb-a30b-a3bcaf809007 type="payment:process" from "asynq:{api02}:active" err: INTERNAL_ERROR: redis eval error: i/o timeout
api02     | asynq: pid=1 2025/08/03 20:40:29.212295 ERROR: Could not remove task id=6f187d47-4eb2-489a-bc3e-f3e34b8e7d16 type="payment:process" from "asynq:{api02}:active" err: INTERNAL_ERROR: redis eval error: i/o timeout
api02     | asynq: pid=1 2025/08/03 20:40:29.213158 INFO: Exiting
api01     | asynq: pid=1 2025/08/03 20:40:29.213228 INFO: Exiting
[Kapi01 exited with code 137
[Kapi02 exited with code 137
redis     | 1:signal-handler (1754253639) Received SIGTERM scheduling shutdown...
redis     | 1:M 03 Aug 2025 20:40:39.941 # Redis is now ready to exit, bye bye...
postgres  | 2025-08-03 20:40:39.943 UTC [1] LOG:  received fast shutdown request
postgres  | 2025-08-03 20:40:39.951 UTC [1] LOG:  aborting any active transactions
postgres  | 2025-08-03 20:40:39.956 UTC [1] LOG:  background worker "logical replication launcher" (PID 81) exited with exit code 1
postgres  | 2025-08-03 20:40:39.958 UTC [76] LOG:  shutting down
postgres  | 2025-08-03 20:40:39.968 UTC [76] LOG:  checkpoint starting: shutdown immediate
postgres  | 2025-08-03 20:40:40.086 UTC [76] LOG:  checkpoint complete: wrote 298 buffers (1.8%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.026 s, sync=0.061 s, total=0.128 s; sync files=30, longest=0.049 s, average=0.003 s; distance=4804 kB, estimate=4804 kB; lsn=0/1DCE7C0, redo lsn=0/1DCE7C0
postgres  | 2025-08-03 20:40:40.093 UTC [1] LOG:  database system is shut down
[Kredis exited with code 0
[Kpostgres exited with code 0
log truncated at line 1000
